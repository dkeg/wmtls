#!/bin/bash
# focus_watcher renamed to fw
# and taking benefit functionality from yawee

wall=$(cat ~/.xinitrc|grep hsetroot|cut -d ' ' -f3|awk '{sub(/&/,"");print}')
BLUR=10

blur(){
  hsetroot -fill $wall -blur ${1:-$BLUR}
}
file=fcs

while IFS=: read ev wid; do
    case $ev in
        # window creation
        16) wattr o $wid || corner md $wid 
        test "$(lsw)" = "$wid" && blur ;;

        # mapping requests
        19) wattr o $wid \
            || $file $wid ;;

        # focus next window when deleting focused window
        18) wattr $(pfw) || $file prev 2>/dev/null
            test -z "$(lsw)" && blur 0 ;;

        # entering window
        7) wattr o $wid || $file $wid ;;
    esac
done
